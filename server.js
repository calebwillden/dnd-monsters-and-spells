/*******************************************************************************
 * REQUIRES
 ******************************************************************************/
const express = require('express');
const cors = require('cors');
const bodyParser = require('body-parser');
const mongoose = require('mongoose');

/*******************************************************************************
 * ENV CONFIG VARS
 ******************************************************************************/
const { port, uri } = require('./config/db.config.js');

/*******************************************************************************
 * EXPRESS APP & MIDDLEWARE
 ******************************************************************************/
const app = express();
app.use(cors());
app.use(bodyParser.json());

/*******************************************************************************
 * ROUTER
 ******************************************************************************/
app.use('/', require('./routes'));

/*******************************************************************************
 * CONNECT TO DATABASE
 ******************************************************************************/
app.listen(port, async () => {
    try {
        await mongoose.connect(uri);
        console.log('Connected to database!');
    } catch (e) {
        console.log(e);
    }
    console.log(`Listening at port ${port}...`);
});
